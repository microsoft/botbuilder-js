steps:
- powershell: |
    # Create .npmrc for SDK_JS_org feed

    Set-Location -Path "$(Build.SourcesDirectory)";

    $content = @"
    registry=https://pkgs.dev.azure.com/FuseLabs/_packaging/SDK_JS_org/npm/registry/
    "@;

    New-Item -Path . -Name ".npmrc" -ItemType "file" -Value $content -Force;

    '-------------'; get-content ".npmrc"; '===================';
  displayName: Create .npmrc for SDK_JS_org feed

- task: npmAuthenticate@0
  inputs:
    workingFile: .npmrc
    customEndpoint: 'SDK_JS_org feed read service connection'
  displayName: authenticate for SDK_JS_org feed

- script: |
    ren yarn.lock yarn_ORIGINAL.lock
    type yarn_ORIGINAL.lock | node build\scripts\rebaseYarnLock.js https://pkgs.dev.azure.com/FuseLabs/_packaging/SDK_JS_org/npm/registry/ > yarn.lock
  displayName: rebase yarn.lock to pull from SDK_JS_org feed
