# Create a React app that uses ReactWebChat and DLJS with the
# latest nightly version of botframework-streaming

steps:
  - script: npm ci
    displayName: npm ci in React App
    workingDirectory: $(ReactProjectDir)

  - script: npm install botframework-streaming@next
    displayName: npm install botframework-streaming@next in React App
    workingDirectory: $(ReactProjectDir)

  - script: 'rm -rf */**/botframework-streaming'
    displayName: remove nested botframework-streaming packages so top level takes precedence
    workingDirectory: $(ReactProjectDir)/node_modules

  - script: npm run build
    displayName: Build React App
    workingDirectory: $(ReactProjectDir)

  - task: PublishPipelineArtifact@1
    displayName: 'Publish Artifact: ReactApp'
    inputs:
      targetPath: $(ReactProjectDir)/build
      artifactName: 'ReactApp'
